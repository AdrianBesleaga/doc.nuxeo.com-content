---
title: Content Automation
review:
    comment: ''
    date: ''
    status: ok
labels:
    - automation-chain
    - 5-7-2
    - automation
toc: true
confluence:
    ajs-parent-page-id: '17334300'
    ajs-parent-page-title: Architecture
    ajs-space-key: NXDOC58
    ajs-space-name: 'Nuxeo Platform Developer Documentation - 5.8 '
    canonical: Content+Automation
    canonical_source: 'https://doc.nuxeo.com/display/NXDOC58/Content+Automation'
    page_id: '17334328'
    shortlink: OIAIAQ
    shortlink_source: 'https://doc.nuxeo.com/x/OIAIAQ'
    source_link: /display/NXDOC58/Content+Automation
history:
    - 
        author: Solen Guitter
        date: '2016-09-02 07:35'
        message: ''
        version: '61'
    - 
        author: Solen Guitter
        date: '2015-08-28 12:27'
        message: ''
        version: '60'
    - 
        author: Solen Guitter
        date: '2013-11-13 14:57'
        message: ''
        version: '59'
    - 
        author: Alain Escaffre
        date: '2013-10-27 20:40'
        message: ''
        version: '58'
    - 
        author: Solen Guitter
        date: '2013-09-20 10:04'
        message: ''
        version: '57'
    - 
        author: Solen Guitter
        date: '2013-09-19 16:33'
        message: ''
        version: '56'
    - 
        author: Solen Guitter
        date: '2013-09-19 16:05'
        message: ''
        version: '55'
    - 
        author: Alain Escaffre
        date: '2013-09-17 01:10'
        message: ''
        version: '54'
    - 
        author: Alain Escaffre
        date: '2013-09-17 01:04'
        message: ''
        version: '53'
    - 
        author: Solen Guitter
        date: '2013-08-30 12:01'
        message: ''
        version: '52'
    - 
        author: Solen Guitter
        date: '2013-07-31 16:17'
        message: Formatting
        version: '51'
    - 
        author: Vladimir Pasquier
        date: '2013-07-23 11:33'
        message: ''
        version: '50'
    - 
        author: Vladimir Pasquier
        date: '2013-07-23 11:30'
        message: ''
        version: '49'
    - 
        author: Vladimir Pasquier
        date: '2013-07-23 11:22'
        message: ''
        version: '48'
    - 
        author: Solen Guitter
        date: '2013-07-17 15:54'
        message: Added related topics
        version: '47'
    - 
        author: Solen Guitter
        date: '2013-07-17 15:47'
        message: 'terminology '
        version: '46'
    - 
        author: Solen Guitter
        date: '2013-07-17 12:03'
        message: ''
        version: '45'
    - 
        author: Vladimir Pasquier
        date: '2013-07-16 16:31'
        message: ''
        version: '44'
    - 
        author: Alain Escaffre
        date: '2013-07-01 13:49'
        message: ''
        version: '43'
    - 
        author: Solen Guitter
        date: '2012-09-14 10:54'
        message: Migrated to Confluence 4.0
        version: '42'
    - 
        author: Solen Guitter
        date: '2012-09-14 10:54'
        message: ''
        version: '41'
    - 
        author: Solen Guitter
        date: '2012-05-21 11:49'
        message: Updated 5.4 mercurial link to 5.6 snapshot github URL
        version: '40'
    - 
        author: Solen Guitter
        date: '2011-11-07 18:24'
        message: corrected links
        version: '39'
    - 
        author: Solen Guitter
        date: '2011-08-30 09:37'
        message: fixed broken link
        version: '38'
    - 
        author: Florent Guillaume
        date: '2011-04-08 11:32'
        message: ''
        version: '37'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 18:25'
        message: ''
        version: '36'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 18:24'
        message: ''
        version: '35'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 18:23'
        message: ''
        version: '34'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 18:13'
        message: ''
        version: '33'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 18:12'
        message: ''
        version: '32'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 18:10'
        message: ''
        version: '31'
    - 
        author: Stéphane Lacoin
        date: '2011-04-06 17:42'
        message: ''
        version: '30'
    - 
        author: Solen Guitter
        date: '2011-03-04 10:12'
        message: ''
        version: '29'
    - 
        author: Alain Escaffre
        date: '2010-08-12 09:12'
        message: ''
        version: '28'
    - 
        author: Alain Escaffre
        date: '2010-08-03 14:18'
        message: ''
        version: '27'
    - 
        author: Stéfane Fermigier
        date: '2010-07-22 22:53'
        message: ''
        version: '26'
    - 
        author: Stéfane Fermigier
        date: '2010-07-22 22:51'
        message: ''
        version: '25'
    - 
        author: Bogdan Stefanescu
        date: '2010-07-20 16:42'
        message: ''
        version: '24'
    - 
        author: Bogdan Stefanescu
        date: '2010-07-20 16:36'
        message: ''
        version: '23'
    - 
        author: Stéfane Fermigier
        date: '2010-07-19 17:18'
        message: ''
        version: '22'
    - 
        author: Stéfane Fermigier
        date: '2010-07-19 17:07'
        message: ''
        version: '21'
    - 
        author: Stéfane Fermigier
        date: '2010-06-28 08:40'
        message: ''
        version: '20'
    - 
        author: Stéfane Fermigier
        date: '2010-06-28 08:26'
        message: ''
        version: '19'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 17:15'
        message: ''
        version: '18'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:47'
        message: ''
        version: '17'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:46'
        message: ''
        version: '16'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:41'
        message: ''
        version: '15'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:37'
        message: ''
        version: '14'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:35'
        message: ''
        version: '13'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:32'
        message: ''
        version: '12'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:31'
        message: ''
        version: '11'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:29'
        message: ''
        version: '10'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:27'
        message: ''
        version: '9'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 01:25'
        message: ''
        version: '8'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 00:57'
        message: ''
        version: '7'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 00:45'
        message: ''
        version: '6'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-25 00:29'
        message: ''
        version: '5'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-24 23:56'
        message: ''
        version: '4'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-22 12:52'
        message: ''
        version: '3'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-22 12:51'
        message: ''
        version: '2'
    - 
        author: Bogdan Stefanescu
        date: '2010-06-22 12:11'
        message: ''
        version: '1'

---
&nbsp;

## What is an Operation?

**From an end-user point of view:** an operation is an action that can be triggered by the user either directly through the user interface, or by responding to an event, or by a REST call to a remote server.

The operations an user can invoke usually deal with the document repository (like creating or updating documents), but they can also do some other tasks like sending emails, converting blobs, etc.

The automation service already provides [tens of frequent operations](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo%20Platform-5.8/listOperations) that you may need to build your business logic. More operations can be contributed using a Nuxeo extension point. This involves of course writing the right Java code to implement the operation logic.

**From a developer point of view:** an operation is a Java class annotated using the right annotations and providing a one or more methods that are doing the actual work.

For more information about how to write and contribute a new operation, see&nbsp;[Contributing an operation]({{page page='contributing-an-operation'}}).

## What is an Automation Chain?

The power of operations is that operations can be chained into a sort of macro operation that is composed of atomic operations and which executes each operation in turn by using an operation output as the input of the next operation.&nbsp;This way you can for example construct an automation chain that creates a document, then attaches a blob to the document, then publishes it and so on. Each operation in the chain does the required step by working on the input of the previous operation and when finished outputs a result that will be used by the next operation as its input.

Since 5.7.2, all chains can contain parameters as operation to be used from the automation context along their execution.

This is called in Nuxeo Automation an **automation chain**. Automation chains give you the possibility to build complex business logic only by assembling atomic operations that are provided by the server. Thus, you can script your business logic using automation chains which, thank to [Nuxeo Studio]({{page space='studio' page='nuxeo-online-services'}}), can be done by using drag and drop (without coding anything or even writing XML extension files).

If you are a developer and don't want to use Nuxeo Studio, you can check the [Contributing an Automation Chain]({{page page='contributing-an-automation-chain'}}) page to see how you can define and contribute a new operation chain using Nuxeo extension points.

## Working with Operations

This section is more about how operations work and how they can be chained to obtain working automation chains.

We've seen that an operation works on an input object by doing something (like updating this object or creating new objects) and at the end it outputs the operation result. When you are constructing a chain of operations, this result will be used as the input of the next operation. The last output in the chain will be the output of the chain itself. As you noticed, an operation works on an input so you should provide an initial input to start an operation (or an operation chain).

More, as there is an [Run Chain](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo%20Platform-5.8/viewOperation/Context.RunOperation) atomic operation which takes as the argument the name of the chain to execute, you can create very complex chains that can call sub-chains to execute some particular steps in the chain.

In a chain, every operation has a cause and an effect. The effect of one operation in a chain is the cause of the next event. The initial cause is the user action (doing something with a document for example), the final effect is what the chain is assumed to do.

An atomic operation can be viewed as a finite automation chain with an initial cause (the action that triggered it) and having the effect of the execution of the operation itself. This way you can chain as many causes and effects you want. You can actually create your ECM universe using operations.

Now, let's discuss about the bricks that compose an operation:

*   An operation has an input (provided by the cause).
*   An operation may have zero or more parameters (used to parametrize the way an operation is behaving).
*   An operation has an output (that can be used by the next operation in the chain as the input).

### The Operation Input

The operation input can be a Document or a Blob (i.e. a file).

The input is provided by the execution context, either by getting the input from the user action (in the case of a single operation or for the first operation in the chain), or from the output of the previous operation when executing a chain.

There are some special operations that don't need any input. For example you may want to run a query in the repository. In this case, you don't need an input for your query operation. Thus, operations can accept void inputs (or nothing as input). To pass a void input to an operation, just use a null value as the input. If an operation doesn't expect any input (i.e, void input) and an input is given, the input will be ignored.

### The Operation Parameters

An operation can define parameters to be able to modify its execution at runtime depending on those parameter values.

Any parameter value can be expressed as a string. The string will be converted to the right type at runtime if possible. If not possible an exception is thrown.

There are several types of predefined parameters:

*   string: any string,
*   boolean: a boolean parameter,
*   integer: an integer number,
*   float: a floating point number,
*   date: a date (in W3C format if is specified as a string),
*   resource: an URL to a resource,
*   properties: a Java properties content (key=value pairs separated by new lines),
*   document: a Nuxeo Document (use its absolute PATH or its UID when expressing it as a string),
*   blob: a Nuxeo blob (the raw content of the blob in the case of a REST invocation),
*   documents: a list of documents,
*   bloblist: a list of blobs,
*   any other object that is convertible from a string: you can register new object converters trough the [`adapters`](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo%20Platform-5.8/viewExtensionPoint/org.nuxeo.ecm.core.operation.OperationServiceComponent--adapters) extension point of the [`org.nuxeo.ecm.core.operation.OperationServiceComponent`](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo%20Platform-5.8/viewComponent/org.nuxeo.ecm.core.operation.OperationServiceComponent) &nbsp;component;
*   an expression: this represents a MVEL expression (which is compatible with basic EL expressions) that can output dynamic values. When using expressions you must prepend it with the prefix&nbsp;_expr:_.&nbsp;
    Example:

    ```
    expr:Document['dc:title']
    ```

    For the complete list of objects and functions available in an expression see [Nuxeo Studio]({{page space='nxdoc' page='use-of-mvel-in-automation-chains'}}).

*   an expression template: this is the same as an expression but it will be interpreted as a string (by doing variable substitution). This is very useful when you want to create expressions like this:

    ```
    expr: SELECT * FROM Document WHERE dc:title LIKE @{mytitle}
    ```

    where `mytitle` is a variable name that will be substituted with its string form.
    You can notice that you still need to prepend your template string with an `expr:` prefix.

### The Operation Output

The operation output is either a Document, a Blob or void (as the input).

In some rare cases you may want your operation to not return anything (a void operation). For example your operation may send an email without returning anything. When an operation is returning void (i.e. nothing), then a null Java object will be returned .

As said before, the output of an operation is the input of the next operation when running in a chain.

### Contributing New Input/Output Types

Since 5.4.2, you can extend the input/output types by contributing the new marshalling logic to automation.

Marshalling and operation binding logic is selected client and server side using the JSON type name. At this stage,&nbsp;we're always using the Java type simple name in lowercase. This makes the operation binding logic being happy.

The logic you need to provide is as follow :

*   the JSON type name,
*   the POJO class,
*   a writing method that puts data extracted from the POJO object into the JSON object,
*   a reading method that gets data from the JSON object and builds a POJO object from it,
*   a reference builder that extracts the server reference from a POJO object,
*   a reference resolver that provides access to a POJO object giving a server reference.

Server and client do not share classes, so you need to provide two marshalling implementation class.

Server side, you should provide a [codec](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo%20Platform-5.8/viewExtensionPoint/org.nuxeo.ecm.automation.server.AutomationServer--codecs). The implementation class is to be contributed to the automation server component using the `codecs` extension point.

```html/xml
  <extension target="org.nuxeo.ecm.automation.server.AutomationServer"
        point="codecs">
        <codec class="org.nuxeo.ecm.automation.server.test.MyObjectCodec" />
  </extension>
```

[`MyObjectCodec`](https://github.com/nuxeo/nuxeo-features/blob/release-5.8/nuxeo-automation/nuxeo-automation-test/src/test/java/org/nuxeo/ecm/automation/server/test/MyObjectCodec.java) class should extend [`org.nuxeo.ecm.automation.server.jaxrs.io.ObjectCodec`](https://github.com/nuxeo/nuxeo-features/blob/release-5.8/nuxeo-automation/nuxeo-automation-io/src/main/java/org/nuxeo/ecm/automation/io/services/codec/ObjectCodec.java). Most common codecs provided by default into Nuxeo server are implemented into [`org.nuxeo.ecm.automation.server.jaxrs.io.ObjectCodecService`](https://github.com/nuxeo/nuxeo-features/blob/release-5.8/nuxeo-automation/nuxeo-automation-io/src/main/java/org/nuxeo/ecm/automation/io/services/codec/ObjectCodecService.java).

Client side, you should implement the `org.nuxeo.ecm.automation.client.jaxrs.spi.JsonMarshaller<T>` interface.&nbsp;The implementation class is to be registered to the automation client marshalling framework by invoking the static method `org.nuxeo.ecm.automation.client.jaxrs.spi.AbstractAutomationClient#registerPojoMarshaller(Clazz marshaller)`.

Here is an example of the [org.nuxeo.ecm.automation.client.jaxrs.spi.marshallers.BooleanMarshaller](https://github.com/nuxeo/nuxeo-features/blob/release-5.8/nuxeo-automation/nuxeo-automation-client/src/main/java/org/nuxeo/ecm/automation/client/jaxrs/spi/marshallers/BooleanMarshaller.java).

### Using Scripting Expression in Operations

Operations can be parametrized using MVEL scripting expressions. For more details about scripting you can look at the page [Use of MVEL in Automation Chains]({{page space='nxdoc' page='use-of-mvel-in-automation-chains'}}).

&nbsp;