---
title: Content Views
review:
    comment: ''
    date: ''
    status: ok
labels:
    - 5-7-1
    - content-views
    - document-content-views
toc: true
confluence:
    ajs-parent-page-id: '17334377'
    ajs-parent-page-title: Customizing the web app
    ajs-space-key: NXDOC58
    ajs-space-name: 'Nuxeo Platform Developer Documentation - 5.8 '
    canonical: Content+Views
    canonical_source: 'https://doc.nuxeo.com/display/NXDOC58/Content+Views'
    page_id: '17334338'
    shortlink: QoAIAQ
    shortlink_source: 'https://doc.nuxeo.com/x/QoAIAQ'
    source_link: /display/NXDOC58/Content+Views
history:
    - 
        author: Solen Guitter
        date: '2016-08-31 14:14'
        message: ''
        version: '50'
    - 
        author: Anahide Tchertchian
        date: '2014-12-17 13:59'
        message: add page-provider label to related content
        version: '49'
    - 
        author: Solen Guitter
        date: '2014-02-24 18:22'
        message: ' NXP-13718 add doc about fixed part configuration'
        version: '48'
    - 
        author: Solen Guitter
        date: '2014-01-23 17:52'
        message: Removed 5.4.2 mentions
        version: '47'
    - 
        author: Solen Guitter
        date: '2014-01-22 16:02'
        message: 'Added related topics, removed 5.4.2 mentions'
        version: '46'
    - 
        author: Solen Guitter
        date: '2013-09-04 16:27'
        message: ''
        version: '45'
    - 
        author: Solen Guitter
        date: '2013-08-06 11:25'
        message: ''
        version: '44'
    - 
        author: Solen Guitter
        date: '2013-07-24 16:41'
        message: Added titles and formatting
        version: '43'
    - 
        author: Thierry Martins
        date: '2013-06-24 11:11'
        message: add an alternative to configure.defaultNavigationResults
        version: '42'
    - 
        author: Solen Guitter
        date: '2013-06-18 14:25'
        message: Changed since 5.7 for 5.7.1
        version: '41'
    - 
        author: Anahide Tchertchian
        date: '2013-04-17 15:43'
        message: wording on maxResults conf
        version: '40'
    - 
        author: Anahide Tchertchian
        date: '2012-09-28 16:56'
        message: Migrated to Confluence 4.0
        version: '39'
    - 
        author: Anahide Tchertchian
        date: '2012-09-28 16:56'
        message: add ad for hotfixes
        version: '38'
    - 
        author: Anahide Tchertchian
        date: '2012-09-28 15:49'
        message: cosmit
        version: '37'
    - 
        author: Anahide Tchertchian
        date: '2012-09-28 15:47'
        message: 'NXP-10155: content view caching improvements '
        version: '36'
    - 
        author: Anahide Tchertchian
        date: '2012-09-20 16:22'
        message: moved misplaced sentence
        version: '35'
    - 
        author: Solen Guitter
        date: '2012-09-11 21:37'
        message: Updated link to 5.7 SNAPSHOT version
        version: '34'
    - 
        author: Anahide Tchertchian
        date: '2012-08-17 09:56'
        message: ''
        version: '33'
    - 
        author: Anahide Tchertchian
        date: '2012-08-17 09:56'
        message: ''
        version: '32'
    - 
        author: Anahide Tchertchian
        date: '2012-07-04 14:18'
        message: ''
        version: '31'
    - 
        author: Anahide Tchertchian
        date: '2012-07-04 14:15'
        message: ''
        version: '30'
    - 
        author: Benoit Delbosc
        date: '2012-06-22 17:45'
        message: ''
        version: '29'
    - 
        author: Benoit Delbosc
        date: '2012-06-22 17:37'
        message: Adding maxResults NXP-9494 doc
        version: '28'
    - 
        author: Solen Guitter
        date: '2012-05-21 11:20'
        message: Updated 5.4 mercurial link to 5.6 snapshot github URL
        version: '27'
    - 
        author: Anahide Tchertchian
        date: '2012-01-20 16:59'
        message: >-
            adding more examples about search document and result columsn
            configuration
        version: '26'
    - 
        author: Anahide Tchertchian
        date: '2011-12-02 12:52'
        message: ''
        version: '25'
    - 
        author: Anahide Tchertchian
        date: '2011-07-04 18:39'
        message: ''
        version: '24'
    - 
        author: Anahide Tchertchian
        date: '2011-05-13 12:06'
        message: ''
        version: '23'
    - 
        author: Anahide Tchertchian
        date: '2011-05-06 14:44'
        message: ''
        version: '22'
    - 
        author: Anahide Tchertchian
        date: '2011-04-26 17:52'
        message: ''
        version: '21'
    - 
        author: Anahide Tchertchian
        date: '2011-04-26 17:31'
        message: ''
        version: '20'
    - 
        author: Anahide Tchertchian
        date: '2011-04-18 18:57'
        message: ''
        version: '19'
    - 
        author: Anahide Tchertchian
        date: '2011-03-15 16:27'
        message: ''
        version: '18'
    - 
        author: Anahide Tchertchian
        date: '2011-03-14 18:14'
        message: >-
            adding new elements information (max page size, show page size
            selector, show refresh page)
        version: '17'
    - 
        author: Anahide Tchertchian
        date: '2011-03-01 15:38'
        message: ''
        version: '16'
    - 
        author: Anahide Tchertchian
        date: '2011-02-15 14:36'
        message: ''
        version: '15'
    - 
        author: Anahide Tchertchian
        date: '2011-02-14 18:20'
        message: ''
        version: '14'
    - 
        author: Anahide Tchertchian
        date: '2011-02-01 15:08'
        message: ''
        version: '13'
    - 
        author: Anahide Tchertchian
        date: '2011-02-01 14:56'
        message: ''
        version: '12'
    - 
        author: Anahide Tchertchian
        date: '2010-11-04 18:11'
        message: ''
        version: '11'
    - 
        author: Anahide Tchertchian
        date: '2010-10-13 15:42'
        message: ''
        version: '10'
    - 
        author: Anahide Tchertchian
        date: '2010-10-13 15:36'
        message: ''
        version: '9'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 12:33'
        message: ''
        version: '8'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 12:31'
        message: ''
        version: '7'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 12:25'
        message: ''
        version: '6'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 12:04'
        message: ''
        version: '5'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 11:33'
        message: ''
        version: '4'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 11:16'
        message: ''
        version: '3'
    - 
        author: Anahide Tchertchian
        date: '2010-07-30 11:16'
        message: ''
        version: '2'
    - 
        author: Anahide Tchertchian
        date: '2010-07-28 17:54'
        message: ''
        version: '1'

---
### The Content View Query

###### `coreQueryPageProvider` element

The `coreQueryPageProvider` element makes it possible to define what query will be performed. Here it is a query on a core session, using a pattern with one parameter.

###### `parameter` and `property` elements

The `coreQueryPageProvider`&nbsp;element accepts any number of property elements, defining needed context variables for the page provider to perform its work. The&nbsp;`coreSession` property is mandatory for a core query to be processed and is bound to the core session proxy named&nbsp;`documentManager` available in a default Nuxeo application.

It also accepts any number of `parameter` elements, where order of definition matters: this EL expression will be resolved when performing the query, replacing the '?' characters it holds.

The main difference between `properties` and `parameters` is that properties will not be recomputed when refreshing the provider, whereas parameters will be. Properties will only be recomputed when resetting the provider.

###### `sort` elements

The&nbsp;`sort` element defines the default sort, that can be changed later through the interface. There can be any number of&nbsp;`sort` elements. The `sortInfosBinding` element can also be defined: it can resolve an EL expression in case the sort info are held by a third party instance (document, Seam component...) and will be used instead of the default sort information if not null or empty. The EL expression can either resolve to a list of `org.nuxeo.ecm.core.api.SortInfo` instances, or a list of map items using keys `sortColumn` (with a String value) and `sortAscending` (with a boolean value).

###### `pageSize` elements

The&nbsp;`pageSize` element defines the default page size, it can also be changed later. The `pageSizeBinding` element can also be defined: it can resolve an EL expression in case the page size is held by a third party instance (document, seam component...), and will be used instead of the default page size if not null.

The optional `maxPageSize` element can be placed at the same level than `pageSize`. It makes it possible to define the maximum page size so that the content view does not overload the server when retrieving a large number of items. When not set, the default value "100" will be used: even when asking for all the results with a page size with value "0" (when exporting the content view in CSV format for instance), only 100 items will be returned. Since 5.6 (and some previous hotfixed versions, see [NXP-9052](https://jira.nuxeo.com/browse/NXP-9052)) this is configurable globally using the runtime property `nuxeo.pageprovider.default-max-page-size`.

###### `maxResults` elements

Since version 5.6, you can set a maximum number of results. This is useful for performance reasons, because it takes time to get the total number of results (and thus the number of pages). If there are more results than the limit, then the number of pages will be unknown. Nevertheless you can still navigate to the next page if it exists.

![]({{file name='content-view-results-exceed-limit.png'}} ?w=650,border=true)

To set this limit you need to add a `maxResults` parameter to `coreQueryPageProvider,` either using an integer value or one of the following keywords:

*   DEFAULT_NAVIGATION_RESULTS: Used by most of the navigation page provider, the default is 200 and it can be overridden using Java options:

    ```
      JAVA_OPTS=$JAVA_OPTS -Dorg.nuxeo.ecm.platform.query.nxql.defaultNavigationResults=1000

    ```

    or you can directly add this line in [nuxeo.conf]({{page space='admindoc58' page='configuration-parameters-index-nuxeoconf'}}):

    ```
     org.nuxeo.ecm.platform.query.nxql.defaultNavigationResults=1000

    ```

*   PAGE_SIZE: this is useful when you are interested in a single page or if you don't need a total count.

###### `whereClause` element

This kind of core query can also perform a more complex form of query, using a document model to store query parameters. Using a document model makes it easy to:

*   use a layout to display the form that will define query parameters;
*   save this document in the repository, so that the same query can be replayed when viewing this document.

Here is an example of such a registration:

```html/xml
<extension target="org.nuxeo.ecm.platform.ui.web.ContentViewService"
  point="contentViews">

  <contentView name="document_content">

    <coreQueryPageProvider>
      <property name="coreSession">#{documentManager}</property>
      <property name="maxResults">DEFAULT_NAVIGATION_RESULTS</property>
      <whereClause docType="AdvancedSearch">

        <predicate parameter="dc:title" operator="FULLTEXT">
          <field schema="advanced_search" name="title" />
        </predicate>

        <predicate parameter="dc:created" operator="BETWEEN">
          <field schema="advanced_search" name="created_min" />
          <field schema="advanced_search" name="created_max" />
        </predicate>

        <predicate parameter="dc:modified" operator="BETWEEN">
          <field schema="advanced_search" name="modified_min" />
          <field schema="advanced_search" name="modified_max" />
        </predicate>

        <predicate parameter="dc:language" operator="LIKE">
          <field schema="advanced_search" name="language" />
        </predicate>

        <predicate parameter="ecm:currentLifeCycleState" operator="IN">
          <field schema="advanced_search" name="currentLifeCycleStates" />
        </predicate>

        <fixedPart>
          ecm:parentId = ? AND ecm:isCheckedInVersion = 0 AND ecm:mixinType !=
          'HiddenInNavigation' AND ecm:currentLifeCycleState != 'deleted'
        </fixedPart>

      </whereClause>
      <parameter>#{currentDocument.id}</parameter>
      <sort column="dc:title" ascending="true" />
      <pageSize>20</pageSize>
    </coreQueryPageProvider>

    <searchLayout name="document_content_search"
      filterDisplayType="quick" />
    <showFilterForm>true</showFilterForm>

    ...

</extension>

```

The above definition holds a `whereClause` element, stating the search document type and predicates explaining how the document model properties will be translated into a NXQL query. It can also state a `fixedPart` element that will added as to the query string. This fixed part can also take parameters using the '?' character and `parameter` elements.

The&nbsp;`fixedPart` element also accepts attributes to better control its behavior:

*   `escapeParameters` is a boolean value that allows to avoid escaping parameters when building the fixed part (defaults to true).
*   `quoteParameters` is a boolean value that allows to avoid adding quotes around the parameter (defaults to true). This is useful when parameters actually hold a complete predicate, for instance (and in this case, the&nbsp;`escapeParameters` element must also be set to true.

Attributes&nbsp;`escapeParameters` and&nbsp;`quoteParameters` are also accepted on the `pattern` element.

###### `searchLayout` element

The `searchLayout` element defines what layouts needs to be used when rendering the search document model: it will be in charge of displaying the search form. Since 5.5, this element accepts a `filterDisplayType` attribute. When set to "quick", it will display a form showing only the first row of the layout, visible directly above the content view results. The whole filter form is then displayed in a popup. Otherwise, the default rendering is used, and the filter form is visible in a foldable box.

The `showFilterForm` element makes it possible to show this form above the content view results.

### The Content View Result Layouts

The result layouts control the display of resulting documents. It states different kinds of rendering so that it's possible to switch between them. They also accept a title and an icon, useful for rendering.

The layout configuration is standard and has to follow listing layouts configuration standards. The layout template, as well as widgets displaying selection checkboxes, need to perform an Ajax selection of documents, and re-render the action buttons region.

### The Content View Selection List

The `selectionList` element will be used to fill the document list with given name.

Selection is done through Ajax, so that selection is not lost when not performing any action thanks to this selection.

### The Content View Actions

The `actions` element can be repeated any number of times: it states the actions category to use to display buttons applying to this table ("copy", "paste", "delete",...). Each `actions` element will generate a new row of buttons.

These actions will be displayed under the table in default templates, and will be re-rendered when selecting an item of the table so that they are enabled or disabled. This is performed using adequate filters, performing checks on selected items.

### Additional Configuration

###### `searchDocument`

The `searchDocument` variable can be used in EL expressions to bind the page size, the sort information and the result columns to the search document properties.

Sample usage:

```html/xml
<contentView name="myContentView">
  <coreQueryPageProvider>
    <property name="coreSession">#{documentManager}</property>
    <whereClause docType="AdvancedSearch">
      <fixedPart>
        ecm:currentLifeCycleState != 'deleted'
      </fixedPart>
      <predicate parameter="dc:title" operator="FULLTEXT">
        <field schema="dublincore" name="title" />
      </predicate>
      <pageSizeBinding>#{searchDocument.cvd.pageSize}</pageSizeBinding>
      <sortInfosBinding>#{searchDocument.cvd.sortInfos}</sortInfosBinding>
    </whereClause>
  </coreQueryPageProvider>
  [...]
</contentView>

```

The `searchDocument` element can be filled on a content view using an EL expression: it will be used as the search document model. Otherwise, a bare document will be generated from the document type.

Sample usage, showing how to add a clause to the search depending on title set on the current document (will display non deleted document with the same title):

```html/xml
<contentView name="sampleContentViewWithCustomSearchDocument">
  <searchDocument>#{currentDocument}</searchDocument>
  <coreQueryPageProvider>
    <property name="coreSession">#{documentManager}</property>
    <whereClause docType="AdvancedSearch">
      <fixedPart>
        ecm:currentLifeCycleState != 'deleted'
      </fixedPart>
      <predicate parameter="dc:title" operator="FULLTEXT">
        <field schema="dublincore" name="title" />
      </predicate>
    </whereClause>
  </coreQueryPageProvider>
</contentView>

```

###### `resultColumns` element

The `resultColumns` element can be filled on a content view using an EL expression: it will be used to resolve the list of selected columns for the current result layout. If several result layouts are defined, they should be configured so that their rows are always selected in case the selected column names do not match theirs.

Sample usage, showing how to reuse the same selected columns than the one selected on the advanced search page:

```html/xml
<contentView name="myContentView">
  [...]
  <resultColumns>
    #{documentSearchActions.selectedLayoutColumns}
  </resultColumns>
</contentView>

```

###### Additional rendering information

Additional rendering information can also be set, to be used by templates when rendering the content view:

```html/xml
<contentView name="CURRENT_DOCUMENT_CHILDREN">
  <title>label.current.document.children</title>
  <translateTitle>true</translateTitle>
  <iconPath>/icons/document_listing_icon.png</iconPath>
  <emptySentence>label.content.empty.search</emptySentence>
  <translateEmptySentence>true</translateEmptySentence>
  <translateEmptySentence>true</translateEmptySentence>
  <showPageSizeSelector>true</showPageSizeSelector>
  <showRefreshCommand>true</showRefreshCommand>

...
</contentView>

```

The element `showTitle` can be used to define a title for the content view, without displaying it on the default rendering. It can also be used when exporting the content view in CSV format, for instance.

The elements `emptySentence` and `translateEmptySentence` are used to display the message stating that there are no elements in the content view.

The elements `showPageSizeSelector` and `showRefreshCommand` are used to control the display of the page size selector, and of the "refresh current page" button. They both default to true.

## Caching

The `cacheKey` element, if filled, will make it possible to keep content views in cache in the current conversation. It accepts EL expressions, but a static cache key can be used to cache only one instance.

The `cacheSize` element is useful to use a queue of cached instances. In the example, 10 instances of content views with a different cache key will be kept in cache. When the 11th entry, with a new cache key, is generated, the first content view put in the cache will be removed, and will need to be re-generated again. This cache configuration will make it possible to navigate to 10 different folderish document pages, and keep the current page, the current sort information, and current result layout.

When caching only one instance, setting the `cacheSize` element to more than "1" is useless. Caching only one instance can be useful when several features need to retrieve information from the same content view.

If a cache key is given, but no cache size is set, "5" will be used by default. Using "0" means no caching at all (and the cache key will be ignored).

Caching is done by a Seam component named&nbsp; [`contentViewActions`](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo%20Platform-5.8/viewSeamComponent/seam:contentViewActions) . Although the cache key, cache size and events configurations handle the most common use cases, it is sometimes useful to call this bean methods directly when forcing a refresh.

The `refresh` and `reset` elements configurations make it possible to refresh/reset this content view when receiving the listed Seam event names. Only&nbsp;`documentChanged` and `documentChildrenChanged` are handled by default, but it is possible to react to new events by adding a method with an observer on this event on a custom Seam component, and call the method `contentViewActions.refreshOnSeamEvent(String seamEventName)` or `contentViewActions.resetPageProviderOnSeamEvent(String seamEventName)`.

Refresh will keep current settings, and will force the query to be done again. Reset will delete content views completely from the cache, and force complete re-generation of the content view, its provider, and the search document model if set.

{{#> callout type='note' heading='cache size "0" behaviour'}}

Before 5.7.1, selection actions were misbehaving when using a cache of size "0", so content views with selections actions needed a cache size of at least "1". Since 5.7.1 (and 5.6-HF02), when using value "0", the content view is cached anyhow, but its page provider is refreshed every time it is rendered.

As this behavior is costly, using refresh events can be enough most of the time. But it is not possible to trigger a refresh for other users when using Seam events, so this configuration makes it possible to make sure the content view is up to date when other users may have an impact on its content.

{{/callout}}

## Document Content Views

It is possible to define content views on a document type. This makes it easier to define folderish documents views.

Here is the default configuration of content views for Nuxeo folderish documents:

```html/xml
<type id="Folder">
  <label>Folder</label>
  ...
  <contentViews category="content">
    <contentView>document_content</contentView>
  </contentViews>
  <contentViews category="trash_content">
    <contentView showInExportView="false">document_trash_content</contentView>
  </contentViews>
</type>

```

The `document_content` content view will be displayed on this folder default view, and the&nbsp;`document_trash_content` content view will be displayed on the Trash tab.

The `category` attribute is filled from XHTML templates to render all content views defined in a given category.

The&nbsp;`showInExportView` attribute is used to check whether this content view should be displayed in the document export view (and PDF export).

If several content views are filled in the same category, both will be displayed on the same page.

## Rendering

Rendering is done using methods set on generic Seam components: [`contentViewActions`](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo Platform-5.8/viewSeamComponent/seam:contentViewActions) (`org.nuxeo.ecm.webapp.contentbrowser.ContentViewActions`) and [`documentContentViewActions`](http://explorer.nuxeo.org/nuxeo/site/distribution/Nuxeo Platform-5.8/viewSeamComponent/seam:documentContentViewActions) (`org.nuxeo.ecm.webapp.contentbrowser.DocumentContentViewActions`) to handle document content views categories.

A typical usage of content views, to render the results, would be:

```html/xml
<nxu:set var="contentViewName" value="my_content_view_name">

  <ui:decorate template="/incl/content_view.xhtml" />

</nxu:set>

```

The template `/incl/content_view.xhtml` handles generic rendering of the given content view (content view title, pagination, result layout selection, list rendering, actions rendering) . It inserts names region that can be overridden when using the `ui:decorate` tag.

The current version of this template is here: [https://github.com/nuxeo/nuxeo-jsf/blob/release-5.8/nuxeo-platform-webapp-base/src/main/resources/web/nuxeo.war/incl/content_view.xhtml](https://github.com/nuxeo/nuxeo-jsf/blob/release-5.8/nuxeo-platform-webapp-base/src/main/resources/web/nuxeo.war/incl/content_view.xhtml).

Here is the sample rendering of the search form defined on a content view named "document_content_filter":

```html/xml
<nxu:set var="contentView"
  value="#{contentViewActions.getContentViewWithProvider('document_content_filter')}"
  cache="true">
  <c:if test="#{contentView != null}">
    <nxl:layout name="#{contentView.searchLayout.name}" mode="edit"
      value="#{contentView.searchDocumentModel}" />
  </c:if>
</nxu:set>

```

Here is a typical way of refreshing or resetting a provider named "advanced_search" from the interface:

```html/xml

<div>
  <h:commandButton value="#{messages['command.search']}"
    action="search_results_advanced"
    styleClass="button">
    <nxu:actionListenerMethod value="#{contentViewActions.refresh('advanced_search')}" />
  </h:commandButton>
  <h:commandButton value="#{messages['command.clearSearch']}"
    action="#{contentViewActions.reset('advanced_search')}"
    immediate="true"
    styleClass="button" />
</div>

```

<div class="row" data-equalizer data-equalize-on="medium"><div class="column medium-6">{{#> panel heading='Related topics in this documentation'}}

*   [Document Content Views]({{page page='document-content-views'}})

{{/panel}}</div><div class="column medium-6">{{#> panel heading='Related topics in Studio documentation'}}

*   [Content Views]({{page space='studio' page='content-views'}})

{{/panel}}</div></div>